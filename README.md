# Russian ETRN Builder

PHP –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω—ã—Ö —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ã—Ö –Ω–∞–∫–ª–∞–¥–Ω—ã—Ö (–≠–¢—Ä–ù) –≤ —Ñ–æ—Ä–º–∞—Ç–µ –§–ù–°.

## –û–ø–∏—Å–∞–Ω–∏–µ

–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–∞ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ XML –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω—ã—Ö —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ã—Ö –Ω–∞–∫–ª–∞–¥–Ω—ã—Ö –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º–∏ –§–ù–° –†–æ—Å—Å–∏–∏. –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Å–æ–∑–¥–∞–Ω–∏–µ –≤—Å–µ—Ö —Ç–∏—Ç—É–ª–æ–≤ –≠–¢—Ä–ù –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤.

### –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ç–∏—Ç—É–ª—ã

| –¢–∏—Ç—É–ª | –ö–æ–¥ –¥–æ–∫—É–º–µ–Ω—Ç–∞ | –û–ø–∏—Å–∞–Ω–∏–µ | –°—Ç–∞—Ç—É—Å |
|-------|---------------|----------|--------|
| –¢1 | ON_TRNACLGROT | –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –≥—Ä—É–∑–µ, –¢–°, –≤–æ–¥–∏—Ç–µ–ª–µ (–ì—Ä—É–∑–æ–æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—å) | ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è |
| –¢2 | ON_TRNACLPPRIN | –ü—Ä–∏–Ω—è—Ç–∏–µ –≥—Ä—É–∑–∞ –∫ –ø–µ—Ä–µ–≤–æ–∑–∫–µ (–ü–µ—Ä–µ–≤–æ–∑—á–∏–∫) | üöß –í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ |
| –¢3 | ON_TRNACLGRPO | –ü—Ä–∏–µ–º–∫–∞ –≥—Ä—É–∑–∞, —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø—Ä–∏ –≤—ã–≥—Ä—É–∑–∫–µ (–ì—Ä—É–∑–æ–ø–æ–ª—É—á–∞—Ç–µ–ª—å) | üöß –í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ |
| –¢4 | ON_TRNACLPVYN | –í—ã–¥–∞—á–∞ –≥—Ä—É–∑–∞, –∑–∞–º–µ—á–∞–Ω–∏—è –ø–æ –≤—ã–≥—Ä—É–∑–∫–µ (–ü–µ—Ä–µ–≤–æ–∑—á–∏–∫) | üöß –í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ |

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- PHP >= 8.1
- –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ DOM –¥–ª—è PHP

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞

### –ß–µ—Ä–µ–∑ Composer

```bash
composer require maxistyle/russian-etrn-builder
```

### –†—É—á–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞

1. –°–∫–∞—á–∞–π—Ç–µ –±–∏–±–ª–∏–æ—Ç–µ–∫—É
2. –ü–æ–¥–∫–ª—é—á–∏—Ç–µ –∞–≤—Ç–æ–∑–∞–≥—Ä—É–∑—á–∏–∫:

```php
require_once 'vendor/autoload.php';
```

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∏—Ç—É–ª–∞ –¢1

```php
<?php

require_once __DIR__ . '/vendor/autoload.php';

use MaxiStyle\EtrnBuilder\DocumentGenerator;
use MaxiStyle\EtrnBuilder\Entities;

// –°–æ–∑–¥–∞–µ–º –∫–æ–Ω—Ç–∞–∫—Ç—ã –≥—Ä—É–∑–æ–æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—è
$contact = new Entities\Contact();
$contact->set('phone', '+7 222 888 44 44');

// –°–æ–∑–¥–∞–µ–º –∞–¥—Ä–µ—Å –≥—Ä—É–∑–æ–æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—è
$address = new Entities\Address();
$address->set('full', '–•–∞–±–∞—Ä–æ–≤—Å–∫–∏–π –∫—Ä–∞–π, –≥ –•–∞–±–∞—Ä–æ–≤—Å–∫, –°—É–≤–æ—Ä–æ–≤–∞ —É–ª–∏—Ü–∞ 82–ê')
    ->set('countryCode', '643');

// –°–æ–∑–¥–∞–µ–º —é—Ä–∏–¥–∏—á–µ—Å–∫–æ–µ –ª–∏—Ü–æ
$ul = new Entities\LegalEntity();
$ul->set('name', '–û–û–û "–ú–ù–û–ì–û–í–û–ó–û–§–§"')
    ->set('inn', '2724218020')
    ->set('kpp', '272301001');

// –°–æ–∑–¥–∞–µ–º —Å–≤–µ–¥–µ–Ω–∏—è –æ –≥—Ä—É–∑–æ–æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª–µ
$svGO = new Entities\Shipper();
$svGO->set('goEksp', 0) // –≥—Ä—É–∑–æ–æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—å –Ω–µ —è–≤–ª—è–µ—Ç—Å—è —ç–∫—Å–ø–µ–¥–∏—Ç–æ—Ä–æ–º
    ->set('ul', $ul)
    ->set('address', $address)
    ->set('contact', $contact);

// –°–æ–∑–¥–∞–µ–º —Å–æ–¥–µ—Ä–∂–∞–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –≥—Ä—É–∑–æ–æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—è
$sodInfGO = new Entities\Shipment();
$sodInfGO->set('svGO', $svGO);

// –°–æ–∑–¥–∞–µ–º –¥–æ–∫—É–º–µ–Ω—Ç –¢1
$doc = new Entities\T1();
$doc->set('numTrN', '–¢–ù-001') // –Ω–æ–º–µ—Ä —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω–æ–π –Ω–∞–∫–ª–∞–¥–Ω–æ–π
    ->set('numOrder', '–ë–µ–∑ –Ω–æ–º–µ—Ä–∞') // –Ω–æ–º–µ—Ä –∑–∞–∫–∞–∑–∞
    ->set('dateTrN', new DateTime()) // –¥–∞—Ç–∞ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω–æ–π –Ω–∞–∫–ª–∞–¥–Ω–æ–π
    ->set('dateOrder', new DateTime()) // –¥–∞—Ç–∞ –∑–∞–∫–∞–∑–∞
    ->set('dateFile', new DateTime()) // –¥–∞—Ç–∞ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è —Ñ–∞–π–ª–∞
    ->set('sodInfGO', $sodInfGO);

// –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º XML
$generator = new DocumentGenerator();

try {
    $xml = $generator->generate($doc);
    $generator->saveToFile($xml, './example.xml');
    
    echo 'XML —Ñ–∞–π–ª —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω!';
} catch (Exception $e) {
    echo '–û—à–∏–±–∫–∞: ' . $e->getMessage();
}
```

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
russian-etrn-builder/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ DocumentGenerator.php      # –û—Å–Ω–æ–≤–Ω–æ–π –∫–ª–∞—Å—Å –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
‚îÇ   ‚îú‚îÄ‚îÄ Builders/                  # –ë–∏–ª–¥–µ—Ä—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–∏—Ç—É–ª–∞
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ DocumentBuilder.php    # –ë–∞–∑–æ–≤—ã–π –±–∏–ª–¥–µ—Ä
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ DocumentBuilderInterface.php
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ T1Builder.php         # –ë–∏–ª–¥–µ—Ä –¥–ª—è —Ç–∏—Ç—É–ª–∞ –¢1
‚îÇ   ‚îú‚îÄ‚îÄ Entities/                  # –°—É—â–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Address.php           # –ê–¥—Ä–µ—Å
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ BaseEntity.php        # –ë–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å —Å—É—â–Ω–æ—Å—Ç–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Contact.php           # –ö–æ–Ω—Ç–∞–∫—Ç–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Document.php          # –ë–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å –¥–æ–∫—É–º–µ–Ω—Ç–∞
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ IP.php                # –ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–π –ø—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª—å
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ SodInfGO.php          # –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –≥—Ä—É–∑–æ–æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—è
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ SvGO.php              # –°–≤–µ–¥–µ–Ω–∏—è –æ –≥—Ä—É–∑–æ–æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª–µ
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ T1.php                # –î–æ–∫—É–º–µ–Ω—Ç —Ç–∏—Ç—É–ª–∞ –¢1
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ UL.php                # –Æ—Ä–∏–¥–∏—á–µ—Å–∫–æ–µ –ª–∏—Ü–æ
‚îÇ   ‚îî‚îÄ‚îÄ Exception/                 # –ò—Å–∫–ª—é—á–µ–Ω–∏—è
‚îÇ       ‚îú‚îÄ‚îÄ UnsupportedDocumentException.php
‚îÇ       ‚îî‚îÄ‚îÄ XMLGenerationException.php
‚îú‚îÄ‚îÄ examples/
‚îÇ   ‚îî‚îÄ‚îÄ t1.php                    # –ü—Ä–∏–º–µ—Ä —Å–æ–∑–¥–∞–Ω–∏—è —Ç–∏—Ç—É–ª–∞ –¢1
‚îú‚îÄ‚îÄ composer.json
‚îî‚îÄ‚îÄ README.md
```

## –û—Å–Ω–æ–≤–Ω—ã–µ –∫–ª–∞—Å—Å—ã

### DocumentGenerator

–û—Å–Ω–æ–≤–Ω–æ–π –∫–ª–∞—Å—Å –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ XML –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤.

**–ú–µ—Ç–æ–¥—ã:**
- `generate(object $document)` - –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç XML —Å—Ç—Ä–æ–∫—É
- `saveToFile(string $xml, string $filename)` - –°–æ—Ö—Ä–∞–Ω—è–µ—Ç XML –≤ —Ñ–∞–π–ª —Å BOM
- `generateToFile(object $document, string $filename)` - –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ñ–∞–π–ª

### –°—É—â–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö

–í—Å–µ —Å—É—â–Ω–æ—Å—Ç–∏ –Ω–∞—Å–ª–µ–¥—É—é—Ç—Å—è –æ—Ç `BaseEntity` –∏ –∏–º–µ—é—Ç –º–µ—Ç–æ–¥—ã:
- `get(string $name)` - –ü–æ–ª—É—á–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ —Å–≤–æ–π—Å—Ç–≤–∞
- `set(string $name, mixed $value)` - –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ —Å–≤–æ–π—Å—Ç–≤–∞

**–û—Å–Ω–æ–≤–Ω—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏:**
- `T1` - –î–æ–∫—É–º–µ–Ω—Ç —Ç–∏—Ç—É–ª–∞ –¢1
- `UL` - –Æ—Ä–∏–¥–∏—á–µ—Å–∫–æ–µ –ª–∏—Ü–æ
- `IP` - –ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–π –ø—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª—å
- `Address` - –ê–¥—Ä–µ—Å
- `Contact` - –ö–æ–Ω—Ç–∞–∫—Ç–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
- `SvGO` - –°–≤–µ–¥–µ–Ω–∏—è –æ –≥—Ä—É–∑–æ–æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª–µ
- `SodInfGO` - –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –≥—Ä—É–∑–æ–æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—è

## –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –¥–≤–∞ —Ç–∏–ø–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–π:

- `UnsupportedDocumentException` - –í—ã–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ —Å–æ–∑–¥–∞—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç –Ω–µ–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º–æ–≥–æ —Ç–∏–ø–∞
- `XMLGenerationException` - –í—ã–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ XML

```php
try {
    $xml = $generator->generate($document);
} catch (MaxiStyle\EtrnBuilder\Exception\UnsupportedDocumentException $e) {
    echo "–ù–µ–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–π —Ç–∏–ø –¥–æ–∫—É–º–µ–Ω—Ç–∞: " . $e->getMessage();
} catch (MaxiStyle\EtrnBuilder\Exception\XMLGenerationException $e) {
    echo "–û—à–∏–±–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ XML: " . $e->getMessage();
}
```

## –õ–∏—Ü–µ–Ω–∑–∏—è

–ü—Ä–æ–µ–∫—Ç —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è–µ—Ç—Å—è –ø–æ–¥ –ª–∏—Ü–µ–Ω–∑–∏–µ–π MIT. –ü–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏ –≤ —Ñ–∞–π–ª–µ [LICENSE](LICENSE).

## –ê–≤—Ç–æ—Ä

**MaxiStyle**
- Email: tiranmax@yandex.ru

## –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –∏–ª–∏ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö —Å–æ–∑–¥–∞–≤–∞–π—Ç–µ issues –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞.

---

*–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–∞ –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º–∏ –§–ù–° –†–æ—Å—Å–∏–∏ –¥–ª—è —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ–≥–æ –¥–æ–∫—É–º–µ–Ω—Ç–æ–æ–±–æ—Ä–æ—Ç–∞ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ã—Ö –Ω–∞–∫–ª–∞–¥–Ω—ã—Ö.*